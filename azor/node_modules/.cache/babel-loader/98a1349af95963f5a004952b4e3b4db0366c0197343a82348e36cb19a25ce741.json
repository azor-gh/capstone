{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/nutzv/OneDrive/Desktop/finaaaal/Capstone_Azor/azor/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/nutzv/OneDrive/Desktop/finaaaal/Capstone_Azor/azor/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/nutzv/OneDrive/Desktop/finaaaal/Capstone_Azor/azor/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Container from\"react-bootstrap/Container\";import Col from\"react-bootstrap/esm/Col\";import Row from\"react-bootstrap/esm/Row\";import BookingCard from\"../../components/cards/users/BookingCard\";import Dropdown from\"react-bootstrap/Dropdown\";import DropdownButton from\"react-bootstrap/DropdownButton\";import Form from\"react-bootstrap/Form\";import InputGroup from\"react-bootstrap/InputGroup\";import{Link}from\"react-router-dom\";import{useBookingsContext}from\"../../components/hooks/useBookingsContext\";import UserBookingPagination from\"../../components/paginations/UserBookingPagination\";import Spinner from\"react-bootstrap/Spinner\";import AddBookingBtn from\"../../components/buttons/AddBookingBtn\";import{useAuthContext}from\"../../components/hooks/useAuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UserBookings=function UserBookings(){var _useAuthContext=useAuthContext(),user=_useAuthContext.user;var _useBookingsContext=useBookingsContext(),bookings=_useBookingsContext.bookings,dispatch=_useBookingsContext.dispatch;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),currentPage=_useState4[0],setCurrentPage=_useState4[1];var _useState5=useState(5),_useState6=_slicedToArray(_useState5,2),postPerPage=_useState6[0],setPostPerPage=_useState6[1];// const [lastPage, setLastPage] = useState(null);\nvar lastPostIndex=currentPage*postPerPage;var firstPostIndex=lastPostIndex-postPerPage;// const currentPosts = bookings.slice(firstPostIndex, lastPostIndex);\n// console.log(currentPosts);\nuseEffect(function(){var fetchBookings=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/bookings\",{headers:{Authorization:\"Bearer \".concat(user.token)}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:json=_context.sent;// pass to a variable to use the data\n// check if response is ok\nif(response.ok){dispatch({type:\"SET_BOOKINGS\",payload:json});setLoading(false);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function fetchBookings(){return _ref.apply(this,arguments);};}();if(user){fetchBookings();}},[dispatch,user]);var viewBooking=function viewBooking(){};var editBooking=function editBooking(){};var countBooking=function countBooking(){};//\nvar _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),data=_useState8[0],setData=_useState8[1];useEffect(function(){var data=JSON.parse(localStorage.getItem(\"user\"));if(data){setData(data);}},[]);var id=data._id;var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),searchTerm=_useState10[0],setsearchTerm=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),selectValue=_useState12[0],setValue=_useState12[1];// selected value in filter\nvar handleSelect=function handleSelect(e){console.log(e,id);setValue(e);};var handleSubmit=function handleSubmit(e){e.preventDefault();setsearchTerm(\"\");};//\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Container,{className:\"mt-3 border-bottom border-secondary\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 d-flex flex-wrap\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Appointments\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ms-auto\",children:/*#__PURE__*/_jsx(AddBookingBtn,{})})]})}),/*#__PURE__*/_jsxs(Container,{className:\"my-3\",children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(InputGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Control,{\"aria-label\":\"Text input with dropdown button\",placeholder:\"Search\",onChange:function onChange(event){setsearchTerm(event.target.value);console.log(searchTerm);}}),/*#__PURE__*/_jsxs(DropdownButton,{variant:\"secondary\",title:\"Filter by\",id:\"input-group-dropdown-2\",align:\"end\",onSelect:handleSelect,children:[/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"brand\",children:\"Brand\"}),/*#__PURE__*/_jsx(Dropdown.Divider,{}),/*#__PURE__*/_jsx(Dropdown.Item,{eventKey:\"stats\",children:\"Status\"})]})]})}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"primary\",size:\"lg\",className:\"mt-5\"})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{sm:12,children:/*#__PURE__*/_jsxs(\"span\",{children:[\"Total \",countBooking(),\" bookings\"]})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:12,children:/*#__PURE__*/_jsx(\"div\",{className:\"flex-column\",children:bookings.filter(function(val){if(searchTerm==\"\"){return val;}else if(val.stats.toLowerCase().includes(searchTerm.toLowerCase())){return val;}}).map(function(booking){return/*#__PURE__*/_jsx(BookingCard,{booking:booking,viewBooking:viewBooking,editBooking:editBooking},booking._id);})})})}),/*#__PURE__*/_jsx(Container,{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(UserBookingPagination,{})})]})]})]});};export default UserBookings;","map":{"version":3,"names":["React","useEffect","useState","Container","Col","Row","BookingCard","Dropdown","DropdownButton","Form","InputGroup","Link","useBookingsContext","UserBookingPagination","Spinner","AddBookingBtn","useAuthContext","UserBookings","user","bookings","dispatch","loading","setLoading","currentPage","setCurrentPage","postPerPage","setPostPerPage","lastPostIndex","firstPostIndex","fetchBookings","fetch","headers","Authorization","token","response","json","ok","type","payload","viewBooking","editBooking","countBooking","data","setData","JSON","parse","localStorage","getItem","id","_id","searchTerm","setsearchTerm","selectValue","setValue","handleSelect","e","console","log","handleSubmit","preventDefault","event","target","value","filter","val","stats","toLowerCase","includes","map","booking"],"sources":["C:/Users/nutzv/OneDrive/Desktop/finaaaal/Capstone_Azor/azor/src/pages/user/UserBookings.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Container from \"react-bootstrap/Container\";\r\nimport Col from \"react-bootstrap/esm/Col\";\r\nimport Row from \"react-bootstrap/esm/Row\";\r\nimport BookingCard from \"../../components/cards/users/BookingCard\";\r\nimport Dropdown from \"react-bootstrap/Dropdown\";\r\nimport DropdownButton from \"react-bootstrap/DropdownButton\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport InputGroup from \"react-bootstrap/InputGroup\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useBookingsContext } from \"../../components/hooks/useBookingsContext\";\r\nimport UserBookingPagination from \"../../components/paginations/UserBookingPagination\";\r\nimport Spinner from \"react-bootstrap/Spinner\";\r\nimport AddBookingBtn from \"../../components/buttons/AddBookingBtn\";\r\nimport { useAuthContext } from \"../../components/hooks/useAuthContext\";\r\n\r\nconst UserBookings = () => {\r\n  const { user } = useAuthContext();\r\n  const { bookings, dispatch } = useBookingsContext();\r\n  const [loading, setLoading] = useState(true);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [postPerPage, setPostPerPage] = useState(5);\r\n  // const [lastPage, setLastPage] = useState(null);\r\n\r\n  const lastPostIndex = currentPage * postPerPage;\r\n  const firstPostIndex = lastPostIndex - postPerPage;\r\n  // const currentPosts = bookings.slice(firstPostIndex, lastPostIndex);\r\n  // console.log(currentPosts);\r\n\r\n  useEffect(() => {\r\n    const fetchBookings = async () => {\r\n      const response = await fetch(\"/api/bookings\", {\r\n        headers: { Authorization: `Bearer ${user.token}` },\r\n      }); // fetch data from the server\r\n      const json = await response.json(); // pass to a variable to use the data\r\n\r\n      // check if response is ok\r\n      if (response.ok) {\r\n        dispatch({ type: \"SET_BOOKINGS\", payload: json });\r\n        setLoading(false);\r\n      }\r\n    };\r\n    if (user) {\r\n      fetchBookings();\r\n    }\r\n  }, [dispatch, user]);\r\n\r\n  const viewBooking = () => {};\r\n  const editBooking = () => {};\r\n\r\n  const countBooking = () => {};\r\n\r\n  //\r\n  const [data, setData] = useState([]);\r\n  useEffect(() => {\r\n    const data = JSON.parse(localStorage.getItem(\"user\"));\r\n    if (data) {\r\n      setData(data);\r\n    }\r\n  }, []);\r\n  const id = data._id;\r\n\r\n  const [searchTerm, setsearchTerm] = useState(\"\");\r\n  const [selectValue, setValue] = useState(\"\"); // selected value in filter\r\n\r\n  const handleSelect = (e) => {\r\n    console.log(e, id);\r\n    setValue(e);\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    setsearchTerm(\"\");\r\n  };\r\n\r\n  //\r\n  return (\r\n    <>\r\n      <Container className=\"mt-3 border-bottom border-secondary\">\r\n        {/* <Row className=\"mb-3\">\r\n          <Col sm={12} lg={8}>\r\n            <h1>My Appointments</h1>\r\n          </Col>\r\n          <Col lg={4}>\r\n            <AddBookingBtn />\r\n          </Col>\r\n        </Row> */}\r\n        <div className=\"mb-3 d-flex flex-wrap\">\r\n          <h1>My Appointments</h1>\r\n\r\n          <div className=\"ms-auto\">\r\n            <AddBookingBtn />\r\n          </div>\r\n        </div>\r\n      </Container>\r\n\r\n      <Container className=\"my-3\">\r\n        {/*  */}\r\n        <form onSubmit={handleSubmit}>\r\n          <InputGroup className=\"mb-3\">\r\n            <Form.Control\r\n              aria-label=\"Text input with dropdown button\"\r\n              placeholder=\"Search\"\r\n              onChange={(event) => {\r\n                setsearchTerm(event.target.value);\r\n                console.log(searchTerm);\r\n              }}\r\n            />\r\n\r\n            <DropdownButton\r\n              variant=\"secondary\"\r\n              title=\"Filter by\"\r\n              id=\"input-group-dropdown-2\"\r\n              align=\"end\"\r\n              onSelect={handleSelect}\r\n            >\r\n              <Dropdown.Item eventKey=\"brand\">Brand</Dropdown.Item>\r\n              <Dropdown.Divider />\r\n              <Dropdown.Item eventKey=\"stats\">Status</Dropdown.Item>\r\n            </DropdownButton>\r\n          </InputGroup>\r\n        </form>\r\n        {/*  */}\r\n        {loading ? (\r\n          <div className=\"d-flex justify-content-center\">\r\n            <Spinner\r\n              animation=\"border\"\r\n              variant=\"primary\"\r\n              size=\"lg\"\r\n              className=\"mt-5\"\r\n            />\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <Row>\r\n              <Col sm={12}>\r\n                <span>Total {countBooking()} bookings</span>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col md={12}>\r\n                <div className=\"flex-column\">\r\n                  {bookings\r\n                    .filter((val) => {\r\n                      if (searchTerm == \"\") {\r\n                        return val;\r\n                      } else if (\r\n                        val.stats\r\n                          .toLowerCase()\r\n                          .includes(searchTerm.toLowerCase())\r\n                      ) {\r\n                        return val;\r\n                      }\r\n                    })\r\n                    .map((booking) => (\r\n                      <BookingCard\r\n                        key={booking._id}\r\n                        booking={booking}\r\n                        viewBooking={viewBooking}\r\n                        editBooking={editBooking}\r\n                      />\r\n                    ))}\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n\r\n            <Container className=\"d-flex justify-content-center\">\r\n              <UserBookingPagination />\r\n            </Container>\r\n          </>\r\n        )}\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default UserBookings;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}